apiVersion: admissionregistration.k8s.io/v1beta1
kind: MutatingWebhookConfiguration
metadata:
  name: sidecar-injector-webhook-cfg
  annotations:
   # put namespace/certificate-name
   cert-manager.io/inject-ca-from: sidecar-injector/sidecar-injector
  labels:
    app: sidecar-injector
webhooks:
- name: sidecar-injector.morven.me
  clientConfig:
    service:
      name: sidecar-injector-webhook-svc
      namespace: sidecar-injector
      path: "/mutate"
    caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURzakNDQXBxZ0F3SUJBZ0lRUWhCUmp2QXVncFhwQlJpbHVLVGh6VEFOQmdrcWhraUc5dzBCQVFzRkFEQTgKTVRvd09BWURWUVFERXpGemFXUmxZMkZ5TFdsdWFtVmpkRzl5TFhkbFltaHZiMnN0YzNaakxuTnBaR1ZqWVhJdAphVzVxWldOMGIzSXVjM1pqTUI0WERUSXdNRGN4TURFeU1UTXhNRm9YRFRJd01UQXdPREV5TVRNeE1Gb3dQREU2Ck1EZ0dBMVVFQXhNeGMybGtaV05oY2kxcGJtcGxZM1J2Y2kxM1pXSm9iMjlyTFhOMll5NXphV1JsWTJGeUxXbHUKYW1WamRHOXlMbk4yWXpDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSzhYYmFCdgphVG01V24zaUFVdUJycGhIZXgvWHhUQUViQ2t3ZHM4MnJIZDN0N0cvamNRdWd0VXgrVUNoSFJVOEkvSGJEWlBFCjhZa1NINjh5NTlzenNmUCtQTWV1ZTI1eDJxajYvN2RaUWttbGFZdGh3R29VOGJ1bElsOUt3aHVBbWtnWGg1aEYKRmRkdE5uT2doRFpwb0VFcXhYaTZhb2toK29xcTQ1MXJySnlGejlqUEFzSHJSaFMybXQ5WS9DWUhEeXJuWC9NQwpjU1dpa0ZmSStBaTZMeXdOb0Y0R3NKczBqZXVQelFFTE03djcxTUlKSkRoUlpWRXlRbGYrVUk5clorMmZ0dUpOCldGam5CTnlHa2xIUkg4dnhQYU9kY2h0NHc3UFdtZFJSUUZJQ1BPVTE1OXhnVmU3TDY4SlcyMHZZektoVythakUKNTF2OTlocE1ZM0hHbzVrQ0F3RUFBYU9CcnpDQnJEQU9CZ05WSFE4QkFmOEVCQU1DQmFBd0RBWURWUjBUQVFILwpCQUl3QURDQml3WURWUjBSQklHRE1JR0FnaHh6YVdSbFkyRnlMV2x1YW1WamRHOXlMWGRsWW1odmIyc3RjM1pqCmdpMXphV1JsWTJGeUxXbHVhbVZqZEc5eUxYZGxZbWh2YjJzdGMzWmpMbk5wWkdWallYSXRhVzVxWldOMGIzS0MKTVhOcFpHVmpZWEl0YVc1cVpXTjBiM0l0ZDJWaWFHOXZheTF6ZG1NdWMybGtaV05oY2kxcGJtcGxZM1J2Y2k1egpkbU13RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUdvWnhKcGd6OUJFN1o0bmlqR0ZxSTRvcVpQdmkzeFZLTG45Cnl3Rjg3d0gyUXQvY1pKOUVEUFMwT3Ywc2oybDVaL1FDUnFNVjF5ZXRzWUlNR3JvVC9sV0dkRXVia3p3ZzZiVDQKWkgzUEZVNjB1MDhCc2I3WjJyQzdCbUN6aDhBcnRwM09iSXFNZVB6cnRRSnhBc1hhZW5aUFVhWXN6eENDenRIRAptSlQrdnB0eTRkL2ZsTStHem8yK21hM0JtM1k5cDlQbDE1cFFuV2RWUWVPbm04MTZveVB1Q1VQUFJIT3FuYWt1CjJMVGxQeERTYTN5MGw4bzMwbmFuckx2SHdWSG85Unh1RzlwOHA5VGIrWFY2RFZiaWRLeDVWYjZmMUQyUEVnMU0KMTVSbENDd2RLZXpiZ01TVmJVOTEwOUkySlg3ZWNnbXdCWVdGN0JENW5qRUh5OUt6NEpzPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  rules:
  - operations: ["CREATE", "UPDATE"]
    apiGroups: [""]
    apiVersions: ["v1"]
    resources: ["pods"]
  namespaceSelector:
    matchLabels:
      sidecar-injection: enabled
